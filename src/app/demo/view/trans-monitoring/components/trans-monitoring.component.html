<div class="ui-g-12 ui-g-nopad" style="margin-bottom: 29vh;">
  <div class="ui-g-12 ui-g-nopad txt-right margin-bottom-40">
    <button pButton type="button" label="파일 올리기" (click)="uploadDialog = true;"></button>
  </div>
  <ul class="ui-g-12 ui-g-nopad select_tab_menu margin-bottom-40" id="selectTab">
    <li tabindex="0" class="on" (click)="selectItem($event)"><a>전체</a></li>
    <li tabindex="1" class="" (click)="selectItem($event)"><a>변환요청</a></li>
    <li tabindex="2" class="" (click)="selectItem($event)"><a>변환진행</a></li>
    <li tabindex="3" class="" (click)="selectItem($event)"><a>변환완료</a></li>
    <li tabindex="4" class="" (click)="selectItem($event)"><a>변환실패</a></li>
  </ul>
  <div class="ui-g-12 ui-g-nopad margin-bottom-50">
    <div class="ui-g-nopad ui-g-12 margin-bottom-30">
      <div class="left">
        <button pButton type="button" label="변환 재시작" class="margin-right-10"></button>
        총 <span class="c_red">{{transMonitoringRowData.length}}</span>개
      </div>
      <div class="right">
        <button pButton type="button" label="새로고침"></button>
      </div>
    </div>
    <div class="ui-g-12 ui-g-nopad margin-bottom-50">
      <p-table #dt class="selectTable" [columns]="transMonitoringCols" [value]="transMonitoringRowData" [resizableColumns]="true" sortField="regdate" [sortOrder]="-1" [paginator]="true" [rows]="20" [rowsPerPageOptions]="[20,50,100]" [(selection)]="tempCompareItems"> <!--selectionMode="multiple" (onRowSelect)="onRowSelect()" (onRowUnselect)="onRowSelect()" -->
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup>
            <col style="width: 3em">
            <col *ngFor="let col of columns" [style.width]="col.width">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th>
              <p-tableHeaderCheckbox></p-tableHeaderCheckbox>
            </th>
            <th *ngFor="let col of columns; let i = index" [pSortableColumn]="col.field" pResizableColumn>
              {{ col.header }}
              <p-sortIcon *ngIf="i !== 0" [field]="col.field" ariaLabel="Activate to sort" ariaLabelDesc="Activate to sort in descending order" ariaLabelAsc="Activate to sort in ascending order"></p-sortIcon>
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns" let-transMonitoring>
          <tr [pSelectableRow]="transMonitoring">
            <td>
              <p-tableCheckbox [value]="transMonitoring"></p-tableCheckbox>
            </td>
            <td>{{ transMonitoring['gf_nm'] }}</td>
            <td>{{ transMonitoring['fo_nm'] }}</td>
            <td>{{ transMonitoring['fo_path'] }}</td>
            <td>{{ transMonitoring['status'] }}</td>
            <td>{{ transMonitoring['ft_progress'] }}%</td>
            <td>{{ transMonitoring['fo_size'] }}MB</td>
            <td>{{ transMonitoring['ft_size'] }}MB</td>
            <td>{{ transMonitoring['ft_start_dtm'] }}</td>
            <td>{{ transMonitoring['ft_end_dtm'] }}</td>
          </tr>
        </ng-template>
        <ng-template pTemplate="emptymessage" let-columns>
          <tr>
            <td [attr.colspan]="columns.length + 1" class="emptyMessage">표시할 데이터가 없습니다.</td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
</div>

<!--
  uploadDialog: 팝업 on/off boolean
  isFileUploading: 업로드-ing boolean
  isCompleteUploading: 업로드 완료 boolean
-->
<p-dialog [(visible)]="uploadDialog" [width]="750" [modal]="true" [showHeader]="false" [style]="{'max-height': '750px', 'overflow-y': 'scroll'}" (onHide)="isFileUploading = false; isCompleteUploading = false;">
  <div class="txt-right margin-top-15">
    <button type="button" class="close_btn" (click)="closePopup()" label="close button"><i class="fas fa-times"></i></button>
  </div>
  <div class="txt-center margin-top-30 margin-bottom-30">
    <h2 class="margin-bottom-40">
      <span *ngIf="!isCompleteUploading">{{ uploadDialogTitle }}</span>
      <span *ngIf="isCompleteUploading"><span class="c_red">0</span> / {{ uploadRowData.length }} 개 인코딩 완료되었습니다.</span>
    </h2>
  </div>
  <!--파일 올리기 및 편집해서 올리기-->
  <div *ngIf="!isFileUploading && !isCompleteUploading">
    <p-tabView (onChange)="changeDialogTitle($event)">
      <p-tabPanel header="파일올리기">
        <div>
          <span class="margin-right-10">미디어보관함</span>
          <p-dropdown [options]="originStorageList" [(ngModel)]="selectedMoveStorage" [style]="{'width': '150px', 'height': '32px', 'padding-left': '10px', 'vertical-align': 'top', 'text-align': 'left', 'background': '#fff'}"></p-dropdown>
          <input type="file" pInputText [(ngModel)]="uploadFiles" placeholder="파일 추가" class="margin-left-10" style="width: 300px; border: 1px solid #ddd; cursor: pointer;">
        </div>
        <div class="margin-top-30 margin-bottom-30" style="max-height: 200px; overflow-y: scroll;">
          총 <span class="c_red">{{ uploadRowData.length }}</span>개 / <span class="c_red">555</span>MB
          <p-table #dt class="selectTable" [columns]="uploadCols" [value]="uploadRowData">
            <ng-template pTemplate="colgroup" let-columns>
              <colgroup>
                <col *ngFor="let col of columns" [style.width]="col.width">
                <col style="width: 2em;">
              </colgroup>
            </ng-template>
            <ng-template pTemplate="header" let-columns>
              <tr>
                <th *ngFor="let col of columns; let i = index" [pSortableColumn]="col.field">
                  {{ col.header }}
                </th>
                <th></th>
              </tr>
            </ng-template>
            <ng-template pTemplate="body" let-rowData let-columns="columns" let-item>
              <tr>
                <td>{{ item.gf_nm }}</td>
                <td>{{ item.fo_nm }}</td>
                <td>{{ item.filetype }}</td>
                <td>{{ item.content_size }} MB</td>
                <td>{{ item.status }}</td>
                <td><p-progressBar [value]="item.progress"></p-progressBar></td>
                <td><button type="button" style="border: none; background: none; color: #ff6400; cursor: pointer;"><i class="fas fa-times"></i></button></td>
              </tr>
            </ng-template>
          </p-table>
        </div>
      </p-tabPanel>
      <p-tabPanel header="편집해서 올리기">
        <div>
          <span class="margin-right-10">미디어보관함</span>
          <p-dropdown [options]="originStorageList" [(ngModel)]="selectedMoveStorage" [style]="{'width': '150px', 'height': '32px', 'padding-left': '10px', 'vertical-align': 'top', 'text-align': 'left', 'background': '#fff'}"></p-dropdown>
          <input type="file" pInputText [(ngModel)]="uploadFiles" placeholder="파일 추가" class="margin-left-10" style="width: 300px; border: 1px solid #ddd; cursor: pointer;">
        </div>
        <div class="margin-top-10 margin-bottom10 txt-center">
          <img src="../../../../../../assets/layout/images/gxp/preivew.png" alt="미리보기 플레이어 영역">
        </div>
        <div class="select-section">
          <ul class="sec_list ui-g-nopad">
            <li class="first_sec" *ngFor="let item of selectSections; let i = index;">
              <button class="close_btn" *ngIf="i !== 0" (click)="removeSelectSection(i)"><i class="fas fa-times"></i></button>
              <span>구간 선택</span>
              <div class="time_sec">
                <input type="text" title="구간 시작 시간" [value]="item.startTime" /> ~ <input type="text" title="구간 끝 시간" [value]="item.endTime" /> / 재생시간 <span>{{ item.fullTime }}</span>
                <div style="padding: 20px 10px;">
                  <p-slider [(ngModel)]="item.selectRange" [range]="true"></p-slider>
                </div>
              </div>
            </li>
          </ul>
          <button type="button" pButton label="구간 추가" (click)="addSelectSection();" style="display: block; margin: 0 auto;"></button>
        </div>
      </p-tabPanel>
    </p-tabView>

    <p-accordion class="margin-top-10">
      <p-accordionTab>
        <p-header>
          인코딩 프리셋 선택 <span routerLink="/settings/user-preset/encoding/list" style="float: right; font-weight: normal; font-size: 13px; text-decoration: underline;">인코딩 프리셋 설정 &gt;</span>
        </p-header>
        <div class="ui-g-12 ui-g-nopad encoding-preset">
          <ul class="ui-g-5 ui-g-nopad encoding-list">
            <li>
              <p-radioButton name="encodingPreset" [(ngModel)]="encodingPreset" value="origin" label="원본"></p-radioButton>
            </li>
            <li>
              <p-radioButton name="encodingPreset" [(ngModel)]="encodingPreset" value="encoding0" label="포맷 변환용"></p-radioButton>
            </li>
            <li>
              <p-radioButton name="encodingPreset" [(ngModel)]="encodingPreset" value="encoding1" label="스마트폰 / 태블릿"></p-radioButton>
            </li>
            <li>
              <p-radioButton name="encodingPreset" [(ngModel)]="encodingPreset" value="encoding2" label="오디오 추출용"></p-radioButton>
            </li>
            <li>
              <p-radioButton name="encodingPreset" [(ngModel)]="encodingPreset" value="encoding3" label="사용자 지정"></p-radioButton> &nbsp;&nbsp;<span class="c_red">영상 편집용</span>
            </li>
            <li>
              <p-radioButton name="encodingPreset" [(ngModel)]="encodingPreset" value="encoding4" label="사용자 지정"></p-radioButton> &nbsp;&nbsp;<span class="c_red">인트로 영상용</span>
            </li>
            <li>
              <p-radioButton name="encodingPreset" [(ngModel)]="encodingPreset" value="encoding4" label="사용자 지정"></p-radioButton> &nbsp;&nbsp;<span class="c_red">포맷 변환용</span>
            </li>
          </ul>
          <div class="ui-g-7 ui-g-nopad encoding-detail">
            <div class="ui-g-12">
              <p class="ui-g-4" style="font-weight: bold;">
                영상 설정
              </p>
              <div class="ui-g-8">
                <div class="ui-g-12"><span class="title">화면크기</span> 340</div>
                <div class="ui-g-12"><span class="title">비율</span> 자동으로 확장</div>
                <div class="ui-g-12"><span class="title">화질/용량</span> 2048Kbps</div>
                <div class="ui-g-12"><span class="title">파일형식</span> MP4</div>
              </div>
            </div>
            <div class="ui-g-12">
              <p class="ui-g-4" style="font-weight: bold;">
                오디오 설정
              </p>
              <div class="ui-g-8">
                <div class="ui-g-12"><span class="title">샘플레이트</span> 48000 Hz 모노</div>
                <div class="ui-g-12"><span class="title">노멀라이저</span> 40</div>
              </div>
            </div>
          </div>
        </div>
      </p-accordionTab>
    </p-accordion>
  </div>
  <!-- 파일 업로드 -->
  <div *ngIf="isFileUploading && !isCompleteUploading">
    <div class="margin-bottom-30">
      전체 파일: 1 / 10 (<span class="c_red">15</span>MB / 555MB) <span class="c_red">업로드 중</span>
      <p-progressBar [value]="65" [style]="{'margin': '10px 0'}"></p-progressBar>
      전체 진행 상황: 00:05:00 / 04:00:00 <span style="float:right;">전체 남은 시간: 03:55:00</span>
    </div>
    <div class="margin-bottom-30">
      파일명: gomedu.mp4 <span class="c_red">업로드 중</span> <span style="float: right;">진행 시간: 00:01:26</span>
      <p-progressBar [value]="12" [style]="{'margin': '10px 0'}"></p-progressBar>
      전체 진행 상황: 00:05:00 / 04:00:00 <span style="float:right;">전체 남은 시간: 03:55:00</span>
    </div>
    <div class="margin-top-50" style="max-height: 200px; overflow-y: scroll;">
      총 <span class="c_red">{{ uploadRowData.length }}</span>개 / <span class="c_red">555</span>MB
      <p-table #dt class="selectTable" [columns]="uploadCols" [value]="uploadRowData">
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup>
            <col *ngFor="let col of columns" [style.width]="col.width">
            <col style="width: 2em;">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th *ngFor="let col of columns; let i = index" [pSortableColumn]="col.field">
              {{ col.header }}
            </th>
            <th></th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns" let-item>
          <tr>
            <td>{{ item.gf_nm }}</td>
            <td>{{ item.fo_nm }}</td>
            <td>{{ item.filetype }}</td>
            <td>{{ item.content_size }} MB</td>
            <td>{{ item.status }}</td>
            <td><p-progressBar [value]="item.progress"></p-progressBar></td>
            <td><button type="button" style="border: none; background: none; color: #ff6400; cursor: pointer;"><i class="fas fa-times"></i></button></td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>
  <!-- 파일 업로드 완료 -->
  <div *ngIf="isCompleteUploading">
    <div class="margin-top-50" style="max-height: 200px; overflow-y: scroll;">
      전체 <span class="c_red">0</span> / {{ uploadRowData.length }} 개 (<span class="c_red">0</span> / 555 MB)
      <p-table #dt class="selectTable" [columns]="uploadCols" [value]="uploadRowData">
        <ng-template pTemplate="colgroup" let-columns>
          <colgroup>
            <col *ngFor="let col of columns" [style.width]="col.width">
          </colgroup>
        </ng-template>
        <ng-template pTemplate="header" let-columns>
          <tr>
            <th *ngFor="let col of columns; let i = index" [pSortableColumn]="col.field">
              {{ col.header }}
            </th>
          </tr>
        </ng-template>
        <ng-template pTemplate="body" let-rowData let-columns="columns" let-item>
          <tr>
            <td>{{ item.gf_nm }}</td>
            <td>{{ item.fo_nm }}</td>
            <td>{{ item.filetype }}</td>
            <td>{{ item.content_size }} MB</td>
            <td>{{ item.status }}</td>
            <td><p-progressBar [value]="item.progress"></p-progressBar></td>
          </tr>
        </ng-template>
      </p-table>
    </div>
  </div>

  <div class="ui-g-12 ui-g-nopad txt-center margin-top-40 margin-bottom-30">
    <button pButton type="button" *ngIf="!isCompleteUploading" (click)="uploadDialog=false;" label="취소" class="margin-right-10"></button>
    <button pButton type="button" *ngIf="!isFileUploading && !isCompleteUploading" (click)="startUploadFiles('인코딩')" label="업로드"></button>
    <button pButton type="button" *ngIf="isFileUploading && !isCompleteUploading" label="일시중지"></button>
    <button pButton type="button" *ngIf="isCompleteUploading" (click)="uploadDialog = false; loadMediaStorageList();" label="미디어보관함 가기" class="margin-right-10"></button>
    <button pButton type="button" *ngIf="isCompleteUploading" label="확인"></button>
  </div>
</p-dialog>